{% include head.html %}

<p>
 <h1 style="display:inline">BHPTNRSurrogate</h1> <span style="float:right;"><a href="{{ site.github.repository_url }}" class = "code_btn">Get the code!</a></span>
</p>

Python code to evaluate gravitational waveform surrogate models 
trained on waveform data generated by 
point-particle black hole perturbation theory (BHPT)
and calibrated to numerical relativity (NR) in the
comparable mass regime. 

![BHPTNR surrogate](/assets/BHPTK-EMRI.png)

<p>
 <h2 style="display:inline">Model Details</h2>
</p>

The BHPTNRSurrogate package provides access to a surrogate gravitational
waveform model. Currently, this package supports one model, BHPTNRSur1dq1e4,
for non-spinning black hole binary systems with mass-ratios varying from 3 to
$10^4$. The "raw" surrogate model is trained on waveform data generated by
point-particle black hole perturbation theory (ppBHPT) and defined as, 
$$
\begin{align}
 h_{\tt S}(t, \theta, \phi; q, \chi_1) = \sum^{\infty}_{\ell=2} \sum_{m=-\ell}^{\ell} h_{\tt S}^{\ell,m}(t; q, \chi_1) ~^{-2}Y_{\ell m}(\theta, \phi) \,,
\end{align}
$$
where $^{-2}Y_{\ell m}$ are the spin$=-2$ weighted spherical harmonics,
$q=m_1/m_2$ is the mass ratio, and $\chi_1$ is the dimensionless spin
on the larger black hole. The surrogate model
provides fast evaluations for the modes, $h_{\tt S}^{\ell,m}$.
Over 50 available $m > 0$ modes are included, including up to $\ell=10$, 
while the $m<0$ modes 
$h^{\ell, -m} = (-1)^{\ell} h^{\ell,m}{}^*$ can be deduced from the $m>0$ modes.

By default, the BHPTNRSurrogate package will return rescaled waveform modes,
$$
\begin{align}
h^{\ell,m}_{\tt S, \alpha}(t ; q, \chi_1)= {\alpha_{\ell}} h^{\ell,m}_{\tt S}\left( t \beta;q, \chi_1 \right) \,,
\end{align}
$$
where the calibration parameters, $\alpha_{\ell}(q,\chi_1)$ and $\beta(q,\chi_1)$, are tuned to NR simulations. We expect most users 
of this package will want the NR-tuned model. To
generate point-particle perturbation theory waveforms without any
tuning to NR set $\alpha_{\ell} = \beta = 1$ in the function slog_surrogate. 

Model details can be found in islam2022surrogate (see citations below). 

<p>
 <h2 style="display:inline">Getting the code</h2> 
</p>

The latest development version will always be available from the project git
repository:

```bash
git clone https://github.com/BlackHolePerturbationToolkit/BHPTNRSurrogate.git
```

This code, in turn, is based on the 
[EMRISurrogate](https://github.com/BlackHolePerturbationToolkit/EMRISurrogate) package,
which is no longer actively maintained. 

<p>
 <h2 style="display:inline">Requirements, Installation, and Usage</h2>
</p>

For details on these topics check out the [README](https://github.com/BlackHolePerturbationToolkit/BHPTNRSurrogate/blob/master/README.md) and
the [Jupyter notebook](https://github.com/BlackHolePerturbationToolkit/BHPTNRSurrogate/blob/master/BHPTNRSurrogate.ipynb).

<p>
 <h2 style="display:inline">Known problems</h2>
</p>

Known bugs are recorded in the
project [bug tracker](https://github.com/BlackHolePerturbationToolkit/BHPTNRSurrogate/issues)

<p>
 <h2 style="display:inline">License</h2>
</p>
This code is distributed under the MIT License. Details can
be found in the [LICENSE file](https://github.com/BlackHolePerturbationToolkit/EMRISurrogate/blob/master/LICENSE).


<p>
 <h2 style="display:inline">Authors</h2>
</p>

Scott Field, Tousif Islam, Gaurav Khanna, Nur Rifat, Vijay Varma 

<p>
 <h2 style="display:inline">Citation guideline</h2>
</p>

If you make use of any module from the Toolkit in your research please acknowledge using "This work makes use of the Black Hole Perturbation Toolkit". If you make use of the non-spinning surrogate model, BHPTNRSur1dq1e4, please cite:

```
@article{islam2022surrogate,
  title={Surrogate model for gravitational wave signals from non-spinning, comparable-to large-mass-ratio black hole binaries built on black hole perturbation theory waveforms calibrated to numerical relativity},
  author={Islam, Tousif and Field, Scott E and Hughes, Scott A and Khanna, Gaurav and Varma, Vijay and Giesler, Matthew and Scheel, Mark A and Kidder, Lawrence E and Pfeiffer, Harald P},
  journal={arXiv preprint arXiv:2204.01972},
  year={2022}
}
```

If you make use of the spin-aligned surrogate model, BHPTNRSur2dq1e3, please cite:

```
@article{Rink:2024swg,
    author = "Rink, Katie and Bachhar, Ritesh and Islam, Tousif and Rifat, Nur E. M. and Gonzalez-Quesada, Kevin and Field, Scott E. and Khanna, Gaurav and Hughes, Scott A. and Varma, Vijay",
    title = "{Gravitational wave surrogate model for spinning, intermediate mass ratio binaries based on perturbation theory and numerical relativity}",
    eprint = "2407.18319",
    archivePrefix = "arXiv",
    primaryClass = "gr-qc",
    month = "7",
    year = "2024"
}
```


Regardless of the model, please cite the following paper which developed the original [software infrastructure](https://github.com/BlackHolePerturbationToolkit/EMRISurrogate) that the BHPTNRSurrogate package is based on:

```
@article{rifat2019surrogate,
  title={A Surrogate Model for Gravitational Wave Signals from Comparable-to Large-Mass-Ratio Black Hole Binaries},
  author={Rifat, Nur EM and Field, Scott E and Khanna, Gaurav and Varma, Vijay},
  journal={arXiv preprint arXiv:1910.10473},
  year={2019}
}
```
